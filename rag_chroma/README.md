# RAG ChromaDB äº¤äº’å¼å‘½ä»¤è¡Œå·¥å…·

ä¸€ä¸ªåŸºäºŽ ChromaDB å’Œ SiliconFlow åµŒå…¥æ¨¡åž‹çš„äº¤äº’å¼ RAG (æ£€ç´¢å¢žå¼ºç”Ÿæˆ) å‘½ä»¤è¡Œå·¥å…·ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ðŸš€ **äº¤äº’å¼ç•Œé¢**: åŸºäºŽæ•°å­—é€‰æ‹©çš„å‹å¥½å‘½ä»¤è¡Œç•Œé¢
- ðŸ“„ **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ PDFã€TXTã€MD æ–‡ä»¶å’Œç›´æŽ¥æ–‡æœ¬è¾“å…¥
- ðŸ” **æ™ºèƒ½æ£€ç´¢**: æ”¯æŒå‘é‡æœç´¢ + é‡æŽ’åºçš„ä¸¤é˜¶æ®µæ£€ç´¢
- ðŸŽ¯ **é‡æŽ’åºæ¨¡åž‹**: é›†æˆ SiliconFlow é‡æŽ’åºæ¨¡åž‹ï¼Œæ˜¾è‘—æé«˜æ£€ç´¢å‡†ç¡®æ€§
- âš™ï¸ **çµæ´»é…ç½®**: å¯é…ç½®çš„åµŒå…¥æ¨¡åž‹ã€é‡æŽ’åºæ¨¡åž‹ã€åˆ†å—ç­–ç•¥ç­‰
- ðŸ—‘ï¸ **æ–‡æ¡£ç®¡ç†**: æ”¯æŒæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢æ–‡æ¡£
- ðŸ“Š **çŠ¶æ€ç›‘æŽ§**: æŸ¥çœ‹çŸ¥è¯†åº“çŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯

## å®‰è£…æ­¥éª¤

### 1. çŽ¯å¢ƒè¦æ±‚
- Python >= 3.9
- ChromaDB æœåŠ¡å™¨è¿è¡Œåœ¨ localhost:8002 (æˆ–å…¶ä»–é…ç½®çš„åœ°å€)

### 2. å®‰è£…ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd rag_chroma

# å®‰è£…ä¾èµ–åŒ…
pip install -r requirements.txt
```

### 3. çŽ¯å¢ƒå˜é‡é…ç½®

è®¾ç½® SiliconFlow API Key:

```bash
export SILICONFLOW_API_KEY="your_api_key_here"
```

æˆ–è€…åœ¨è¿è¡Œæ—¶æ‰‹åŠ¨è¾“å…¥ã€‚

### 4. å¯åŠ¨ ChromaDB æœåŠ¡å™¨

```bash
# ä½¿ç”¨ Docker å¯åŠ¨ ChromaDB æœåŠ¡å™¨
docker run -p 8002:8000 chromadb/chroma:latest
```

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨äº¤äº’å¼ç•Œé¢

```bash
python run.py
```

### ä¸»è¦åŠŸèƒ½

1. **åˆå§‹åŒ–çŸ¥è¯†åº“**: åˆ›å»ºæˆ–è¿žæŽ¥åˆ° ChromaDB é›†åˆ
2. **æ·»åŠ æ–‡æ¡£**:
   - ä»Žæ–‡ä»¶è·¯å¾„æ·»åŠ  (æ”¯æŒ PDF/TXT/MD)
   - ç›´æŽ¥è¾“å…¥æ–‡æœ¬å†…å®¹
3. **æ™ºèƒ½æ£€ç´¢**:
   - ä¼ ç»Ÿå‘é‡æœç´¢
   - ä¸¤é˜¶æ®µæ£€ç´¢ (å‘é‡æœç´¢ + é‡æŽ’åº)
   - æ”¯æŒå¤šç§é‡æŽ’åºæ¨¡åž‹
4. **æŸ¥çœ‹çŠ¶æ€**: æ˜¾ç¤ºçŸ¥è¯†åº“é…ç½®å’Œç»Ÿè®¡ä¿¡æ¯
5. **åˆ é™¤æ–‡æ¡£**: æ ¹æ®æ¥æºåç§°åˆ é™¤æ–‡æ¡£
6. **é…ç½®è®¾ç½®**: ä¿®æ”¹æœåŠ¡å™¨åœ°å€ã€æ¨¡åž‹å‚æ•°ç­‰

### ä½¿ç”¨ç¤ºä¾‹

1. å¯åŠ¨ç¨‹åºåŽï¼Œé¦–å…ˆé€‰æ‹© `1` åˆå§‹åŒ–çŸ¥è¯†åº“
2. è¾“å…¥çŸ¥è¯†åº“åç§° (å¦‚: `my_knowledge_base`)
3. é€‰æ‹© `2` æ·»åŠ æ–‡æ¡£ï¼Œè¾“å…¥æ–‡ä»¶è·¯å¾„
4. é€‰æ‹© `4` è¿›è¡Œæ™ºèƒ½æ£€ç´¢ï¼š
   - è¾“å…¥æŸ¥è¯¢æ–‡æœ¬
   - é€‰æ‹©æ˜¯å¦ä½¿ç”¨é‡æŽ’åº (æŽ¨èé€‰æ‹© "æ˜¯")
   - é€‰æ‹©é‡æŽ’åºæ¨¡åž‹ (æŽ¨èä½¿ç”¨é»˜è®¤çš„ BGE æ¨¡åž‹)

## é‡æŽ’åºåŠŸèƒ½è¯¦è§£

### ðŸŽ¯ ä»€ä¹ˆæ˜¯é‡æŽ’åºï¼Ÿ

é‡æŽ’åºæ˜¯ä¸€ç§ä¸¤é˜¶æ®µæ£€ç´¢ç­–ç•¥ï¼š

1. **ç¬¬ä¸€é˜¶æ®µ - ç²—æŽ’**: ä½¿ç”¨å‘é‡æœç´¢å¿«é€Ÿç­›é€‰å€™é€‰æ–‡æ¡£
2. **ç¬¬äºŒé˜¶æ®µ - ç²¾æŽ’**: ä½¿ç”¨é‡æŽ’åºæ¨¡åž‹å¯¹å€™é€‰æ–‡æ¡£è¿›è¡Œç²¾ç¡®æŽ’åº

### ðŸ“Š æ•ˆæžœå¯¹æ¯”

| æ£€ç´¢æ–¹å¼ | é€Ÿåº¦ | å‡†ç¡®æ€§ | é€‚ç”¨åœºæ™¯ |
|---------|------|--------|----------|
| çº¯å‘é‡æœç´¢ | å¿« | ä¸­ç­‰ | ç®€å•æŸ¥è¯¢ |
| å‘é‡+é‡æŽ’åº | ä¸­ç­‰ | é«˜ | å¤æ‚æŸ¥è¯¢ |

### ðŸ¤– æ”¯æŒçš„é‡æŽ’åºæ¨¡åž‹

- **BAAI/bge-reranker-v2-m3** (æŽ¨è): å¹³è¡¡æ€§èƒ½å’Œå‡†ç¡®æ€§
- **Pro/BAAI/bge-reranker-v2-m3**: æ›´é«˜ç²¾åº¦ç‰ˆæœ¬
- **Qwen/Qwen3-Reranker-8B**: æœ€é«˜ç²¾åº¦ï¼Œé€‚åˆå­¦æœ¯ç ”ç©¶
- **Qwen/Qwen3-Reranker-4B**: ä¸­ç­‰ç²¾åº¦ï¼Œå¹³è¡¡é€‰æ‹©
- **Qwen/Qwen3-Reranker-0.6B**: å¿«é€ŸæŽ¨ç†ï¼Œé€‚åˆå®žæ—¶åº”ç”¨

### ðŸ’¡ ä½¿ç”¨å»ºè®®

- å¯¹äºŽé‡è¦æŸ¥è¯¢ï¼Œå»ºè®®ä½¿ç”¨é‡æŽ’åºåŠŸèƒ½
- åˆå§‹æ£€ç´¢å»ºè®®è®¾ç½®ä¸ºæœ€ç»ˆç»“æžœçš„ 3-5 å€
- æ ¹æ®å»¶è¿Ÿè¦æ±‚é€‰æ‹©åˆé€‚çš„é‡æŽ’åºæ¨¡åž‹

## é…ç½®é€‰é¡¹

### åµŒå…¥æ¨¡åž‹é…ç½®
- **æ¨¡åž‹**: `Qwen/Qwen3-Embedding-8B` (é»˜è®¤)
- **å‘é‡ç»´åº¦**: 1024 (é»˜è®¤)
- **æ‰¹å¤„ç†å¤§å°**: 32 (é»˜è®¤)

### åˆ†å—ç­–ç•¥
- **åˆ†å—å¤§å°**: 1000 å­—ç¬¦ (é»˜è®¤)
- **é‡å å¤§å°**: 100 å­—ç¬¦ (é»˜è®¤)

### æœåŠ¡å™¨é…ç½®
- **ä¸»æœº**: localhost (é»˜è®¤)
- **ç«¯å£**: 8002 (é»˜è®¤)

## æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **ModuleNotFoundError: No module named 'redis'**
   ```bash
   pip install redis
   ```

2. **KeyError: '_type'**
   - ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ langchain-chroma
   - æ£€æŸ¥ ChromaDB æœåŠ¡å™¨ç‰ˆæœ¬å…¼å®¹æ€§

3. **API Key é”™è¯¯**
   - ç¡®ä¿è®¾ç½®äº†æ­£ç¡®çš„ SILICONFLOW_API_KEY
   - æ£€æŸ¥ API Key æ˜¯å¦æœ‰æ•ˆ

4. **è¿žæŽ¥ ChromaDB å¤±è´¥**
   - ç¡®ä¿ ChromaDB æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
   - æ£€æŸ¥ä¸»æœºå’Œç«¯å£é…ç½®

### ç‰ˆæœ¬å…¼å®¹æ€§

- ChromaDB: >= 0.5.0, < 0.6.0
- LangChain: >= 0.2.15, < 0.3.0
- langchain-chroma: >= 0.1.0, < 0.2.0

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒäº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- é›†æˆ SiliconFlow åµŒå…¥æ¨¡åž‹
- æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼
- åŸºæœ¬çš„ CRUD æ“ä½œ

## è´¡çŒ®

æ¬¢è¿Žæäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License
